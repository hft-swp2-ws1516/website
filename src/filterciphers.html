<!-- Filterbox -->
<div id="filterBoxPanel" class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">Filter Settings</h3>
    </div>
    <div class="panel-body">
        <div>
            <form id="filterBox" name="filterBox">
                <fieldset>
                    <fieldset>
                        <legend>Top Level Domain</legend>
                        <input id="filterTLD" list="tl_domains" placeholder="Type here to get started!" onblur="removeSpecialChars(this)" />
                        <datalist id="tl_domains">
                            <option value=".com"></option>
                            <option value=".org"></option>
                            <option value=".net"></option>
                            <option value=".int"></option>
                            <option value=".edu"></option>
                            <option value=".gov"></option>
                            <option value=".mil"></option>
                            <option value=".arpa"></option>
                            <option value=".ac">Ascension Island (.ac)</option>
                            <option value=".ad">Andorra (.ad)</option>
                            <option value=".ae">United Arab Emirates (.ae)</option>
                            <option value=".af">Afghanistan (.af)</option>
                            <option value=".ag">Antigua and Barbuda (.ag)</option>
                            <option value=".ai">Anguilla (.ai)</option>
                            <option value=".al">Albania (.al)</option>
                            <option value=".am">Armenia (.am)</option>
                            <option value=".an">Netherlands Antilles (.an)</option>
                            <option value=".ao">Angola (.ao)</option>
                            <option value=".aq">Antarctique (.aq)</option>
                            <option value=".ar">Argentina (.ar)</option>
                            <option value=".as">American Samoa (.as)</option>
                            <option value=".at">Austria (.at)</option>
                            <option value=".au">Australia (.au)</option>
                            <option value=".aw">Aruba (.aw)</option>
                            <option value=".ax">Aland (.ax)</option>
                            <option value=".az">Azerbaijan (.az)</option>
                            <option value=".ba">Bosnia and Herzegovina (.ba)</option>
                            <option value=".bb">Barbados (.bb)</option>
                            <option value=".db">Bangladesh (.db)</option>
                            <option value=".be">Belgium (.be)</option>
                            <option value=".bf">Burkina Faso (.bf)</option>
                            <option value=".bg">Bulgaria (.bg)</option>
                            <option value=".bh">Bahrain (.bh)</option>
                            <option value=".bi">Burundi (.bi)</option>
                            <option value=".bj">Benin (.bj)</option>
                            <option value=".bm">Bermuda (.bm)</option>
                            <option value=".bn">Brunei (.bn)</option>
                            <option value=".bo">Bolivia (.bo)</option>
                            <option value=".bq">Bonaire (.bq)</option>
                            <option value=".br">Brazil (.br)</option>
                            <option value=".bs">Bahamas (.bs)</option>
                            <option value=".bt">Bhutan (.bt)</option>
                            <option value=".bv">Bouvet Island (.bv)</option>
                            <option value=".bw">Botswana (.bw)</option>
                            <option value=".by">Belarus (.by)</option>
                            <option value=".bz">Belize (.bz)</option>
                            <option value=".ca">Canada (.ca)</option>
                            <option value=".cc">Cocos (.cc)</option>
                            <option value=".cd">Democratic Republic of the Congo (.cd)</option>
                            <option value=".cf">Central African Republic (.cf)</option>
                            <option value=".cg">Republic of the Congo (.cg)</option>
                            <option value=".ch">Switzerland (.ch)</option>
                            <option value=".ci">Côte d'Ivoire (.ci)</option>
                            <option value=".ck">Cook Islands (.ck)</option>
                            <option value=".cl">Chile (.cl)</option>
                            <option value=".cm">Cameroon (.cm)</option>
                            <option value=".cn">People's Republic of China (.cn)</option>
                            <option value=".co">Colombia (.co)</option>
                            <option value=".cr">Costa Rica (.cr)</option>
                            <option value=".cs">Serbia and Montenegro (.cs)</option>
                            <option value=".cu">Cuba (.cu)</option>
                            <option value=".cv">Cape Verde (.cv)</option>
                            <option value=".cw">Curaçao (.cw)</option>
                            <option value=".cx">Christmas Island (.cx)</option>
                            <option value=".cy">Cyprus (.cy)</option>
                            <option value=".cz">Czech Republic (.cz)</option>
                            <option value=".de">Germany (.de)</option>
                            <option value=".dj">Djibouti (.dj)</option>
                            <option value=".dk">Denmark (.dk)</option>
                            <option value=".dm">Dominika (.dm)</option>
                            <option value=".do">Dominican Republic (.do)</option>
                            <option value=".dz">Algeria (.dz)</option>
                            <option value=".ec">Ecuador (.ec)</option>
                            <option value=".ee">Estonia (.ee)</option>
                            <option value=".eg">Egypt (.eg)</option>
                            <option value=".eh">Western Sahara (.eh)</option>
                            <option value=".er">Eritrea (.er)</option>
                            <option value=".es">Spain (.es)</option>
                            <option value=".et">Ethiopia (.et)</option>
                            <option value=".eu">European Union (.eu)</option>
                            <option value=".fi">Finland (.fi)</option>
                            <option value=".fj">Fiji (.fj)</option>
                            <option value=".fk">Falkland Islands (.fk)</option>
                            <option value=".fm">Federated States of Micronesia (.fm)</option>
                            <option value=".fo">Faroe Islands (.fo)</option>
                            <option value=".fr">France (.fr)</option>
                            <option value=".ga">Gabon (.ga)</option>
                            <option value=".gb">United Kingdom (.gb)</option>
                            <option value=".gd">Grenada (.gd)</option>
                            <option value=".ge">Georgia (.ge)</option>
                            <option value=".gf">French Guiana( (.gf)</option>
                            <option value=".gg">Guernsey (.gg)</option>
                            <option value=".gh">Ghana (.gh)</option>
                            <option value=".gi">Gibraltar (.gi)</option>
                            <option value=".gl">Greenland (.gl)</option>
                            <option value=".gm">The Gambia (.gm)</option>
                            <option value=".gn">Guinea (.gn)</option>
                            <option value=".gp">Guadeloupe (.gp)</option>
                            <option value=".gq">Equatorial Guinea (.gq)</option>
                            <option value=".gr">Greece (.gr)</option>
                            <option value=".gs">South Georgia and the South Sandwich Islands (.gs)</option>
                            <option value=".gt">Guatemala (.gt)</option>
                            <option value=".gu">Guam (.gu)</option>
                            <option value=".gw">Guinea-Bissau (.gw)</option>
                            <option value=".gy">Guyana (.gy)</option>
                            <option value=".hk">Hong Kong (.hk)</option>
                            <option value=".hm">Heard Island and McDonald Islands (.hm)</option>
                            <option value=".hn">Honduras (.hn)</option>
                            <option value=".hr">Croatia (.hr)</option>
                            <option value=".ht">Haiti (.ht)</option>
                            <option value=".hu">Hungary (.hu)</option>
                            <option value=".id">Indonesia (.id)</option>
                            <option value=".ie">Ireland (.ie)</option>
                            <option value=".il">Israel (.il)</option>
                            <option value=".im">Isle of Man (.im)</option>
                            <option value=".in">India (.in)</option>
                            <option value=".io">British Indian Ocean Territory</option>
                            <option value=".iq">Iraq (.iq)</option>
                            <option value=".ir">Iran (.ir)</option>
                            <option value=".is">Iceland (.is)</option>
                            <option value=".it">Italy (.it)</option>
                            <option value=".je">Jersey (.je)</option>
                            <option value=".jm">Jamaica (.jm)</option>
                            <option value=".jo">Jordan (.jo)</option>
                            <option value=".jp">Japan (.jp)</option>
                            <option value=".ke">Kenya (.ke)</option>
                            <option value=".kg">Kyrgyzstan (.kg)</option>
                            <option value=".kh">Cambodia (.kh)</option>
                            <option value=".ki">Kiribati (.ki)</option>
                            <option value=".km">Comoros (.km)</option>
                            <option value=".kn">Saint Kitts and Nevis (.kn)</option>
                            <option value=".kp">Democratic People's Republic of Korea (.kp)</option>
                            <option value=".kr">Republic of Korea (.kr)</option>
                            <option value=".krd">Kurdistan (.krd)</option>
                            <option value=".kw">Kuwait (.kw)</option>
                            <option value=".ky">Cayman Islands (.ky)</option>
                            <option value=".kz">Kazakhstan (.kz)</option>
                            <option value=".la">Laos (.la)</option>
                            <option value=".lb">Lebanon (.lb)</option>
                            <option value=".lc">Saint Lucia (.lc)</option>
                            <option value=".li">Liechtenstein (.li)</option>
                            <option value=".lk">Sri Lanka (.lk)</option>
                            <option value=".lr">Liberia (.lr)</option>
                            <option value=".ls">Lesotho (.ls)</option>
                            <option value=".lt">Lithuania (.lt)</option>
                            <option value=".lu">Luxembourg (.lu)</option>
                            <option value=".lv">Latvia (.lv)</option>
                            <option value=".ly">Lybia (.ly)</option>
                            <option value=".ma">Morocco (.ma)</option>
                            <option value=".mc">Monaco (.mc)</option>
                            <option value=".md">Moldova (.md)</option>
                            <option value=".me">Montenegro</option>
                            <option value=".mg">Madagascar (.mg)</option>
                            <option value=".mh">Marshall Islands (.mh)</option>
                            <option value=".mk">Macedonia (.mk)</option>
                            <option value=".ml">Mali (.ml)</option>
                            <option value=".mm">Myanmar (.mm)</option>
                            <option value=".mn">Mongolia (.mn)</option>
                            <option value=".mo">Macau (.mo)</option>
                            <option value=".mp">Northern Mariana Islands (.mp)</option>
                            <option value=".mq">Martinique (.mq)</option>
                            <option value=".mr">Mauretania (.mr)</option>
                            <option value=".ms">Montserrat (.ms)</option>
                            <option value=".mt">Malta (.mt)</option>
                            <option value=".mu">Mauritius (.mu)</option>
                            <option value=".mv">Maldives (.mv)</option>
                            <option value=".mw">Malawi (.mw)</option>
                            <option value=".mx">Mexico (.mx)</option>
                            <option value=".my">Malaysia (.my)</option>
                            <option value=".mz">Mozambique (.mz)</option>
                            <option value=".na">Namibia (.na)</option>
                            <option value=".nc">New Caledonia (.nc)</option>
                            <option value=".ne">Niger (.ne)</option>
                            <option value=".nf">Norfolk Island (.nf)</option>
                            <option value=".ng">Nigeria (.ng)</option>
                            <option value=".ni">Nicaragua (.ni)</option>
                            <option value=".nl">Netherlands (.nl)</option>
                            <option value=".no">Norway (.no)</option>
                            <option value=".np">Nepal (.np)</option>
                            <option value=".nr">Nauru (.nr)</option>
                            <option value=".nu">Niue (.nu)</option>
                            <option value=".nz">New Zealand (.nz)</option>
                            <option value=".om">Oman (.om)</option>
                            <option value=".pa">Panama (.pa)</option>
                            <option value=".pe">Peru (.pe)</option>
                            <option value=".pf">French Polynesia (.pf)</option>
                            <option value=".pg">Papua New Guinea (.pg)</option>
                            <option value=".ph">Philippines (.ph)</option>
                            <option value=".pk">Pakistan (.pk)</option>
                            <option value=".pl">Poland (.pl)</option>
                            <option value=".pm">Saint-Pierre et Miquelon (.pm)</option>
                            <option value=".pn">Pitcairn Islands (.pn)</option>
                            <option value=".pr">Puerto Rico (.pr)</option>
                            <option value=".ps">Palestine (.ps)</option>
                            <option value=".pt">Portugal (.pt)</option>
                            <option value=".pw">Palau (.pw)</option>
                            <option value=".py">Paraquay (.py)</option>
                            <option value=".qa">Qatar (.qa)</option>
                            <option value=".re">Réunion (.re)</option>
                            <option value=".ro">Romania (.ro)</option>
                            <option value=".rs">Serbia (.rs)</option>
                            <option value=".ru">Russia (.ru)</option>
                            <option value=".rw">Rwanda (.rw)</option>
                            <option value=".sa">Saudi Arabia (.sa)</option>
                            <option value=".sb">Solomon Islands (.sb)</option>
                            <option value=".sc">Seychelles (.sc)</option>
                            <option value=".sd">Sudan (.sd)</option>
                            <option value=".se">Sweden (.se)</option>
                            <option value=".sg">Singapore (.sg)</option>
                            <option value=".sh">Saint Helena (.sh)</option>
                            <option value=".si">Slovenia (.si)</option>
                            <option value=".sj">Svalbard and Jan Mayen Islands</option>
                            <option value=".sk">Slovakia (.sk)</option>
                            <option value=".sl">Sierra Leone (.sl)</option>
                            <option value=".sm">San Marino (.sm)</option>
                            <option value=".sn">Senegal (.sn)</option>
                            <option value=".so">Somalia (.so)</option>
                            <option value=".sr">Suriname (.sr)</option>
                            <option value=".ss">South Sudan (.ss)</option>
                            <option value=".st">São Tomé and Príncipe (.st)</option>
                            <option value=".su">Soviet Union (.su)</option>
                            <option value=".sv">El Salvador (.sv)</option>
                            <option value=".sx">Sint Maarten (.sx)</option>
                            <option value=".sy">Syria (.sy)</option>
                            <option value=".sz">Swaziland (.sz)</option>
                            <option value=".tc">Turcs and Caicos Islands (.tc)</option>
                            <option value=".td">Chad (.td)</option>
                            <option value=".tf">French Southern and Antarctic Lands (.tf)</option>
                            <option value=".tg">Togo (.tg)</option>
                            <option value=".th">Thailand (.th)</option>
                            <option value=".tj">Tajikistan (.tj)</option>
                            <option value=".tk">Tokelau (.tk)</option>
                            <option value=".tl">East Timor (.tl)</option>
                            <option value=".tm">Turkmenistan (.tm)</option>
                            <option value=".tn">Tunisia (.tn)</option>
                            <option value=".to">Tonga (.to)</option>
                            <option value=".tl">East Timor (.tl (formerly .tp))</option>
                            <option value=".tr">Turkey (.tr)</option>
                            <option value=".tt">Trinidad and Tobago (.tt)</option>
                            <option value=".tv">Tuvalu (.tv)</option>
                            <option value=".tw">Taiwan (.tw)</option>
                            <option value=".tz">Tanzania (.tz)</option>
                            <option value=".ua">Ukraine (.ua)</option>
                            <option value=".ug">Uganda (.ug)</option>
                            <option value=".uk">United Kingdom (.uk)</option>
                            <option value=".us">United States of America (.us)</option>
                            <option value=".uy">Uruguay (.uy)</option>
                            <option value=".uz">Uzbekistan (.uz)</option>
                            <option value=".va">Vatican City (.va)</option>
                            <option value=".vc">Saint Vincent and the Grenadines (.vc)</option>
                            <option value=".ve">Venezuela (.ve)</option>
                            <option value=".vg">British Virgin Islands (.vg)</option>
                            <option value=".vi">United States Virgin Islands (.vi)</option>
                            <option value=".vn">Vietnam (.vn)</option>
                            <option value=".vu">Vanuatu (.vu)</option>
                            <option value=".wf">Wallis and Futuna (.wf)</option>
                            <option value=".ws">Samoa (.ws)</option>
                            <option value=".ye">Yemen (.ye)</option>
                            <option value=".yt">Mayotte (.yt)</option>
                            <option value=".za">South Africa (.za)</option>
                            <option value=".zm">Zambia (.zm)</option>
                            <option value=".zr">Zaire (.zr)</option>
                            <option value=".zw">Zimbabwe (.zw)</option>
                        </datalist>
                    </fieldset>
                    <fieldset>
                        <legend>SSL / TLS Version</legend>
                        <input id="filterProtocol" list="ssl_tls" 
                               onblur="displayFilter(); removeSpecialChars(this)" />
                        <datalist id="ssl_tls">
                            <option value="SSLv2"></option>
                            <option value="SSLv3"></option>
                            <option value="TLSv1.0"></option>
                            <option value="TLSv1.1"></option>
                            <option value="TLSv1.2"></option>
                        </datalist>
                    </fieldset>
                    <fieldset>
                        <legend>Key Exchange and Authentication</legend>
                        <input id="filterKeyExAndAuth" list="keyExAuth"
                               onblur="displayFilter(); removeSpecialChars(this)" />
                        <datalist id="keyExAuth">
                            <option value="AECDH"></option>
                            <option value="RSA"></option>
                            <option value="DH-RSA"></option>
                            <option value="DHE-RSA"></option>
                            <option value="ECDH-RSA"></option>
                            <option value="ECDHE-RSA"></option>
                            <option value="EDH-RSA"></option>
                            <option value="DH-DSS"></option>
                            <option value="DHE-DSS"></option>
                            <option value="ECDH-ECDSA"></option>
                            <option value="ECDHE-ECDSA"></option>
                            <option value="PSK"></option>
                            <option value="PSK-RSA"></option>
                            <option value="DHE-PSK"></option>
                            <option value="ECDHE-PSK"></option>
                            <option value="SRP"></option>
                            <option value="SRP-DSS"></option>
                            <option value="SRP-RSA"></option>
                            <option value="KERBEROS"></option>
                            <option value="DH-ANON"></option>
                            <option value="ECDH-ANON"></option>
                            <option value="GOST"></option>"
                        </datalist>
                    </fieldset>
                    <fieldset>
                        <legend>Bulk Cipher and Key Length (in bits)</legend>
                        <input id="filterCipher" list="cipher" 
                               onblur="displayFilter(); removeSpecialChars(this)" />
                        <datalist id="cipher">
                            <option value="AES"></option>
                            <option value="AES-GCM"></option>
                            <option value="AES-CCM"></option>
                            <option value="AES-CBC"></option>
                            <option value="CAMELLIA"></option>
                            <option value="CAMELLIA-GCM"></option>
                            <option value="CAMELLIA-CBC"></option>
                            <option value="ARIA-GCM"></option>
                            <option value="ARIA-CBC"></option>
                            <option value="SEED-CBC"></option>
                            <option value="DES-CBC3"></option>
                            <option value="GOST-28147-89-CNT"></option>
                            <option value="IDEA-CBC"></option>
                            <option value="DES-CBC"></option>
                            <option value="RC2-CBC"></option>
                            <option value="ChaCha-20-POLY1305"></option>
                            <option value="RC4"></option>
                        </datalist>
                        <input id="filterKeyLen" list="keyLen"
                               onblur="displayFilter(); removeSpecialChars(this)" />
                        <datalist id="keyLen">
                            <option value="40"></option>
                            <option value="56"></option>
                            <option value="112"></option>
                            <option value="128"></option>
                            <option value="256"></option>
                        </datalist>
                    </fieldset>
                    <fieldset>
                        <legend>Message Authenticity</legend>
                        <input id="filterMsgAuth" list="msgAuth"
                               onblur="displayFilter(); removeSpecialChars(this)" />
                        <datalist id="msgAuth">
                            <option value="MD5"></option>
                            <option value="SHA"></option>
                            <option value="SHA1"></option>
                            <option value="SHA256"></option>
                            <option value="SHA384"></option>
                            <option value="AEAD"></option>
                            <option value="GOST-28147-89-IMIT"></option>
                            <option value="GOST-R34.11-94"></option>
                        </datalist>
                    </fieldset>
                    <fieldset>
                        <legend>Time Span</legend>
                        <fieldset>
                            <div id="filterDateStart" class="input-group date">
                                <input type="text" class="form-control" />
                                <span class="input-group-addon">
                                    <i class="glyphicon glyphicon-th"></i>
                                </span>
                            </div>
                            <script type="text/javascript">
                                $('#filterDateStart').datepicker({
                                    format: "mm/yyyy",
                                    startView: 1,
                                    minViewMode: 1,
                                    autoclose: true,
                                    startDate: "12.2015"
                                }).on('changeDate', function (e) {
                                    var day = 0;
                                    var month = e.date.getMonth();
                                    var year = e.date.getFullYear();
                                    if (month === 11) {
                                        month = 1;
                                        year++;
                                    } else {
                                        month += 2;
                                    }
                                    var startDate = new Date(year, month, day);
                                    $('#filterDateEnd').datepicker('setStartDate', startDate);
                                });</script>
                        </fieldset>
                        <br/>
                        <fieldset>
                            <div id="filterDateEnd" class="input-group date">
                                <input type="text" class="form-control" />
                                <span class="input-group-addon">
                                    <i class="glyphicon glyphicon-th"></i>
                                </span>
                            </div>
                            <script type="text/javascript">
                                $('#filterDateEnd').datepicker({
                                    format: "mm/yyyy",
                                    startView: 1,
                                    minViewMode: 1,
                                    autoclose: true,
                                    startDate: "01.2016"
                                });</script>
                        </fieldset>
                        <br/>
                    </fieldset>
                    <fieldset data-role="controlgroup">
                        <input checked="checked" type="radio" name="matching" id="matchingKindLiteral" value="literal" 
                               onchange="displayFilter()" />
                        <label for="matchingKindLiteral">Match literally</label>
                        <br/>
                        <input type="radio" name="matching" id="matchingKindAsPart" value="asPart"
                               onchange="displayFilter()" />
                        <label for="matchingKindAsPart">Match as part of a cipher string</label>
                    </fieldset>
                    <br/>
                    <fieldset>
                        <p align="center">Current cipher string to search for:</p>
                        <p id="displayFilterSelection" align="center"></p>
                    </fieldset>
                    <fieldset>
                        <div id="filterButtons">
                            <input id="filterApply" type="button" value="Apply Filter" />
                            <input id="filterReset" type="reset" value="Reset Filter" onClick="resetFilters()" />
                        </div>
                    </fieldset>
                    <script>
                        var result = null;
                        var tryCount = 0;
                        $("#filterApply").click(function () {
                            result = applyFilters();
                            if (result !== null) {
                                tryCount = 0;
                                if (result.manualProtocolAggregation) {
                                    if (document.getElementById("matchingKindLiteral").checked) {
                                        filteredChartGeneral = c3.generate({
                                            bindto: '#general',
                                            legend: {
                                                show: true,
                                                position: 'bottom'
                                            },
                                            size: {
                                                width: 640
                                            },
                                            data: {
                                                x: 'x',
                                                columns: [
                                                    result.months,
                                                    result.totalHosts,
                                                    result.hostsAcceptingSSL2,
                                                    result.hostsPreferringSSL2,
                                                    result.hostsAcceptingSSL3,
                                                    result.hostsPreferringSSL3,
                                                    result.hostsAcceptingTLS1,
                                                    result.hostsPreferringTLS1,
                                                    result.hostsAcceptingTLS11,
                                                    result.hostsPreferringTLS11,
                                                    result.hostsAcceptingTLS12,
                                                    result.hostsPreferringTLS12
                                                ],
                                                type: 'bar',
                                                types: {
                                                    'Total Number of Hosts': 'spline'
                                                },
                                                groups: [
                                                    ['Hosts Preferring (SSLv2)', 'Hosts Accepting (SSLv2)'],
                                                    ['Hosts Preferring (SSLv3)', 'Hosts Accepting (SSLv3)'],
                                                    ['Hosts Preferring (TLSv1.0)', 'Hosts Accepting (TLSv1.0)'],
                                                    ['Hosts Preferring (TLSv1.1)', 'Hosts Accepting (TLSv1.1)'],
                                                    ['Hosts Preferring (TLSv1.2)', 'Hosts Accepting (TLSv1.2)']
                                                ]
                                            },
                                            axis: {
                                                x: {
                                                    type: 'timeseries',
                                                    tick: {
                                                        culling: false,
                                                        format: '%m-%Y'
                                                    }
                                                }
                                            },
                                            bar: {
                                                width: {
                                                    ratio: 0.2
                                                }
                                            }
                                        });
                                        forComparison_General = c3.generate({
                                            legend: {
                                                show: true,
                                                position: 'bottom'
                                            },
                                            size: {
                                                width: 640
                                            },
                                            data: {
                                                x: 'x',
                                                columns: [
                                                    result.months,
                                                    result.totalHosts,
                                                    result.hostsAcceptingSSL2,
                                                    result.hostsPreferringSSL2,
                                                    result.hostsAcceptingSSL3,
                                                    result.hostsPreferringSSL3,
                                                    result.hostsAcceptingTLS1,
                                                    result.hostsPreferringTLS1,
                                                    result.hostsAcceptingTLS11,
                                                    result.hostsPreferringTLS11,
                                                    result.hostsAcceptingTLS12,
                                                    result.hostsPreferringTLS12
                                                ],
                                                type: 'bar',
                                                types: {
                                                    'Total Number of Hosts': 'spline'
                                                },
                                                groups: [
                                                    ['Hosts Preferring (SSLv2)', 'Hosts Accepting (SSLv2)'],
                                                    ['Hosts Preferring (SSLv3)', 'Hosts Accepting (SSLv3)'],
                                                    ['Hosts Preferring (TLSv1.0)', 'Hosts Accepting (TLSv1.0)'],
                                                    ['Hosts Preferring (TLSv1.1)', 'Hosts Accepting (TLSv1.1)'],
                                                    ['Hosts Preferring (TLSv1.2)', 'Hosts Accepting (TLSv1.2)']
                                                ]
                                            },
                                            axis: {
                                                x: {
                                                    type: 'timeseries',
                                                    tick: {
                                                        culling: false,
                                                        format: '%m-%Y'
                                                    }
                                                }
                                            },
                                            bar: {
                                                width: {
                                                    ratio: 0.2
                                                }
                                            }
                                        });
                                        document.getElementById("rememberGeneral").style = "display: block; margin: 0 auto;";
                                    } else {
                                        noCipherSuites_Accepted = c3.generate({
                                            bindto: '#noCipherSuites_Accepted',
                                            legend: {
                                                show: true,
                                                position: 'bottom'
                                            },
                                            size: {
                                                width: 640
                                            },
                                            data: {
                                                x: 'x',
                                                columns: [
                                                    result.months,
                                                    result.totalCiphersAccepting,
                                                    result.hostsAcceptingSSL2,
                                                    result.hostsAcceptingSSL3,
                                                    result.hostsAcceptingTLS1,
                                                    result.hostsAcceptingTLS11,
                                                    result.hostsAcceptingTLS12,
                                                    result.hostsAccepting
                                                ],
                                                type: 'bar',
                                                types: {
                                                    'Total: Cipher Suites Accepted': 'spline',
                                                    'Matching: Cipher Suites Accepted (All Protocols)': 'spline'
                                                }
                                            },
                                            axis: {
                                                x: {
                                                    type: 'timeseries',
                                                    tick: {
                                                        culling: false,
                                                        format: '%m-%Y'
                                                    }
                                                }
                                            },
                                            bar: {
                                                width: {
                                                    ratio: 0.2
                                                }
                                            }
                                        });
                                        forComparison_NoCipherSuitesAccepted = c3.generate({
                                            legend: {
                                                show: true,
                                                position: 'bottom'
                                            },
                                            size: {
                                                width: 640
                                            },
                                            data: {
                                                x: 'x',
                                                columns: [
                                                    result.months,
                                                    result.totalCiphersAccepting,
                                                    result.hostsAcceptingSSL2,
                                                    result.hostsAcceptingSSL3,
                                                    result.hostsAcceptingTLS1,
                                                    result.hostsAcceptingTLS11,
                                                    result.hostsAcceptingTLS12,
                                                    result.hostsAccepting
                                                ],
                                                type: 'bar',
                                                types: {
                                                    'Total: Cipher Suites Accepted': 'spline',
                                                    'Matching: Cipher Suites Accepted (All Protocols)': 'spline'
                                                }
                                            },
                                            axis: {
                                                x: {
                                                    type: 'timeseries',
                                                    tick: {
                                                        culling: false,
                                                        format: '%m-%Y'
                                                    }
                                                }
                                            },
                                            bar: {
                                                width: {
                                                    ratio: 0.2
                                                }
                                            }
                                        });
                                        document.getElementById("rememberNoCipherSuites_Accepted").style = "display: block; margin: 0 auto;";
                                        noCipherSuites_Preferred = c3.generate({
                                            bindto: '#noCipherSuites_Preferred',
                                            legend: {
                                                show: true,
                                                position: 'bottom'
                                            },
                                            size: {
                                                width: 640
                                            },
                                            data: {
                                                x: 'x',
                                                columns: [
                                                    result.months,
                                                    result.totalCiphersPreferring,
                                                    result.hostsPreferringSSL2,
                                                    result.hostsPreferringSSL3,
                                                    result.hostsPreferringTLS1,
                                                    result.hostsPreferringTLS11,
                                                    result.hostsPreferringTLS12,
                                                    result.hostsPreferring
                                                ],
                                                type: 'bar',
                                                types: {
                                                    'Total: Cipher Suites Preferred': 'spline',
                                                    'Matching: Cipher Suites Preferred (All Protocols)': 'spline'
                                                }
                                            },
                                            axis: {
                                                x: {
                                                    type: 'timeseries',
                                                    tick: {
                                                        culling: false,
                                                        format: '%m-%Y'
                                                    }
                                                }
                                            },
                                            bar: {
                                                width: {
                                                    ratio: 0.2
                                                }
                                            }
                                        });
                                        forComparison_NoCipherSuitesPreferred = c3.generate({
                                            legend: {
                                                show: true,
                                                position: 'bottom'
                                            },
                                            size: {
                                                width: 640
                                            },
                                            data: {
                                                x: 'x',
                                                columns: [
                                                    result.months,
                                                    result.totalCiphersPreferring,
                                                    result.hostsPreferringSSL2,
                                                    result.hostsPreferringSSL3,
                                                    result.hostsPreferringTLS1,
                                                    result.hostsPreferringTLS11,
                                                    result.hostsPreferringTLS12,
                                                    result.hostsPreferring
                                                ],
                                                type: 'bar',
                                                types: {
                                                    'Total: Cipher Suites Preferred': 'spline',
                                                    'Matching: Cipher Suites Preferred (All Protocols)': 'spline'
                                                }
                                            },
                                            axis: {
                                                x: {
                                                    type: 'timeseries',
                                                    tick: {
                                                        culling: false,
                                                        format: '%m-%Y'
                                                    }
                                                }
                                            },
                                            bar: {
                                                width: {
                                                    ratio: 0.2
                                                }
                                            }
                                        });
                                        document.getElementById("rememberNoCipherSuites_Preferred").style = "display: block; margin: 0 auto;";
                                        var totalCiphersAcceptedKey = result.totalCiphersAccepting[0];
                                        var totalCiphersAcceptedValue = result.totalCiphersAccepting[result.totalCiphersAccepting.length - 1];
                                        var hostsAcceptingKey = result.hostsAccepting[0];
                                        var hostsAcceptingValue = result.hostsAccepting[result.hostsAccepting.length - 1];
                                        var percentageTotalCiphersAccepting = Math.round((hostsAcceptingValue / totalCiphersAcceptedValue * 100) * 100) / 100;
                                        var totalCiphersPreferredKey = result.totalCiphersPreferring[0];
                                        var totalCiphersPreferredValue = result.totalCiphersPreferring[result.totalCiphersPreferring.length - 1];
                                        var hostsPreferringKey = result.hostsPreferring[0];
                                        var hostsPreferringValue = result.hostsPreferring[result.hostsPreferring.length - 1];
                                        var percentageTotalCiphersPreferring = Math.round((hostsPreferringValue / totalCiphersPreferredValue * 100) * 100) / 100;
                                        lastMonth_Accepted = c3.generate({
                                            bindto: '#lastMonth_Accepted',
                                            legend: {
                                                show: true,
                                                position: 'right'
                                            },
                                            size: {
                                                width: 640,
                                                height: 200
                                            },
                                            padding: {
                                                bottom: 20
                                            },
                                            gauge: {
                                                label: {
                                                    show: false,
                                                    format: function (value, ratio) {
                                                        return "";
                                                    }
                                                }
                                            },
                                            color: {
                                                pattern: ['#E5AC32', '#326BE5'],
                                                threshold: {
                                                    values: [percentageTotalCiphersAccepting + 0.01, 100]
                                                }
                                            },
                                            data: {
                                                columns: [
                                                    [totalCiphersAcceptedKey, 100],
                                                    [hostsAcceptingKey, percentageTotalCiphersAccepting]
                                                ],
                                                type: 'gauge'
                                            }
                                        });
                                        forComparison_LastMonthAccepted = c3.generate({
                                            legend: {
                                                show: true,
                                                position: 'right'
                                            },
                                            size: {
                                                width: 640,
                                                height: 200
                                            },
                                            padding: {
                                                bottom: 20
                                            },
                                            gauge: {
                                                label: {
                                                    show: false,
                                                    format: function (value, ratio) {
                                                        return "";
                                                    }
                                                }
                                            },
                                            color: {
                                                pattern: ['#E5AC32', '#326BE5'],
                                                threshold: {
                                                    values: [percentageTotalCiphersAccepting + 0.01, 100]
                                                }
                                            },
                                            data: {
                                                columns: [
                                                    [totalCiphersAcceptedKey, 100],
                                                    [hostsAcceptingKey, percentageTotalCiphersAccepting]
                                                ],
                                                type: 'gauge'
                                            }
                                        });
                                        document.getElementById("rememberLastMonth_Accepted").style = "display: block; margin: 0 auto;";
                                        lastMonth_Preferred = c3.generate({
                                            bindto: '#lastMonth_Preferred',
                                            legend: {
                                                show: true,
                                                position: 'right'
                                            },
                                            size: {
                                                width: 640,
                                                height: 200
                                            },
                                            padding: {
                                                bottom: 20
                                            },
                                            gauge: {
                                                label: {
                                                    show: false,
                                                    format: function (value, ratio) {
                                                        return "";
                                                    }
                                                }
                                            },
                                            color: {
                                                pattern: ['#E5AC32', '#326BE5'],
                                                threshold: {
                                                    values: [percentageTotalCiphersPreferring + 0.01, 100]
                                                }
                                            },
                                            data: {
                                                columns: [
                                                    [totalCiphersPreferredKey, 100],
                                                    [hostsPreferringKey, percentageTotalCiphersPreferring]
                                                ],
                                                type: 'gauge'
                                            }
                                        });
                                        forComparison_LastMonthPreferred = c3.generate({
                                            legend: {
                                                show: true,
                                                position: 'right'
                                            },
                                            size: {
                                                width: 640,
                                                height: 200
                                            },
                                            padding: {
                                                bottom: 20
                                            },
                                            gauge: {
                                                label: {
                                                    show: false,
                                                    format: function (value, ratio) {
                                                        return "";
                                                    }
                                                }
                                            },
                                            color: {
                                                pattern: ['#E5AC32', '#326BE5'],
                                                threshold: {
                                                    values: [percentageTotalCiphersPreferring + 0.01, 100]
                                                }
                                            },
                                            data: {
                                                columns: [
                                                    [totalCiphersPreferredKey, 100],
                                                    [hostsPreferringKey, percentageTotalCiphersPreferring]
                                                ],
                                                type: 'gauge'
                                            }
                                        });
                                        document.getElementById("rememberLastMonth_Preferred").style = "display: block; margin: 0 auto;";
                                    }
                                } else {
                                    if (document.getElementById("matchingKindLiteral").checked) {
                                        filteredChartGeneral = c3.generate({
                                            bindto: '#general',
                                            legend: {
                                                show: true,
                                                position: 'right'
                                            },
                                            size: {
                                                width: 640
                                            },
                                            data: {
                                                x: 'x',
                                                columns: [
                                                    result.months,
                                                    result.totalHosts,
                                                    result.hostsAccepting,
                                                    result.hostsPreferring
                                                ],
                                                types: {
                                                    'Total Number of Hosts': 'spline',
                                                    'Hosts Accepting': 'spline',
                                                    'Hosts Preferring': 'spline'
                                                }
                                            },
                                            axis: {
                                                x: {
                                                    type: 'timeseries',
                                                    tick: {
                                                        culling: false,
                                                        format: '%m-%Y'
                                                    }
                                                }
                                            }
                                        });
                                        forComparison_General = c3.generate({
                                            legend: {
                                                show: true,
                                                position: 'right'
                                            },
                                            size: {
                                                width: 640
                                            },
                                            data: {
                                                x: 'x',
                                                columns: [
                                                    result.months,
                                                    result.totalHosts,
                                                    result.hostsAccepting,
                                                    result.hostsPreferring
                                                ],
                                                types: {
                                                    'Total Number of Hosts': 'spline',
                                                    'Hosts Accepting': 'spline',
                                                    'Hosts Preferring': 'spline'
                                                }
                                            },
                                            axis: {
                                                x: {
                                                    type: 'timeseries',
                                                    tick: {
                                                        culling: false,
                                                        format: '%m-%Y'
                                                    }
                                                }
                                            }
                                        });
                                        document.getElementById("rememberGeneral").style = "display: block; margin: 0 auto;";
                                        if (result.months.length > 1) {
                                            var totalHostsKey = result.totalHosts[0];
                                            var totalHostsValue = result.totalHosts[result.totalHosts.length - 1];
                                            var hostsAcceptingKey = result.hostsAccepting[0];
                                            var hostsAcceptingValue = result.hostsAccepting[result.hostsAccepting.length - 1];
                                            var hostsPreferringKey = result.hostsPreferring[0];
                                            var hostsPreferringValue = result.hostsPreferring[result.hostsPreferring.length - 1];
                                            var percentageAccepting = Math.round((hostsAcceptingValue / totalHostsValue * 100) * 100) / 100;
                                            var percentagePreferring = Math.round((hostsPreferringValue / totalHostsValue * 100) * 100) / 100;
                                            filteredChartLastMonth = c3.generate({
                                                bindto: '#lastMonth_General',
                                                legend: {
                                                    show: true,
                                                    position: 'right'
                                                },
                                                size: {
                                                    width: 640,
                                                    height: 200
                                                },
                                                padding: {
                                                    bottom: 20
                                                },
                                                gauge: {
                                                    label: {
                                                        show: false,
                                                        format: function (value, ratio) {
                                                            return "";
                                                        }
                                                    }
                                                },
                                                color: {
                                                    pattern: ['#60B044', '#F97600', '#326BE5'],
                                                    threshold: {
                                                        values: [percentagePreferring + 0.01, percentageAccepting + 0.01, 100]
                                                    }
                                                },
                                                data: {
                                                    columns: [
                                                        [totalHostsKey, 100],
                                                        [hostsAcceptingKey, percentageAccepting],
                                                        [hostsPreferringKey, percentagePreferring]
                                                    ],
                                                    type: 'gauge'
                                                }
                                            });
                                            forComparison_LastMonthGeneral = c3.generate({
                                                legend: {
                                                    show: true,
                                                    position: 'right'
                                                },
                                                size: {
                                                    width: 640,
                                                    height: 200
                                                },
                                                padding: {
                                                    bottom: 20
                                                },
                                                gauge: {
                                                    label: {
                                                        show: false,
                                                        format: function (value, ratio) {
                                                            return "";
                                                        }
                                                    }
                                                },
                                                color: {
                                                    pattern: ['#60B044', '#F97600', '#326BE5'],
                                                    threshold: {
                                                        values: [percentagePreferring + 0.01, percentageAccepting + 0.01, 100]
                                                    }
                                                },
                                                data: {
                                                    columns: [
                                                        [totalHostsKey, 100],
                                                        [hostsAcceptingKey, percentageAccepting],
                                                        [hostsPreferringKey, percentagePreferring]
                                                    ],
                                                    type: 'gauge'
                                                }
                                            });
                                            document.getElementById("rememberLastMonth_General").style = "display: block; margin: 0 auto;";
                                        }
                                    } else {
                                        noCipherSuites_Accepted = c3.generate({
                                            bindto: '#noCipherSuites_Accepted',
                                            legend: {
                                                show: true,
                                                position: 'right'
                                            },
                                            size: {
                                                width: 640
                                            },
                                            data: {
                                                x: 'x',
                                                columns: [
                                                    result.months,
                                                    result.totalCiphersAccepting,
                                                    result.hostsAccepting
                                                ],
                                                types: {
                                                    'Total: Cipher Suites Accepted': 'spline',
                                                    'Cipher Suites Accepted': 'spline'
                                                }
                                            },
                                            axis: {
                                                x: {
                                                    type: 'timeseries',
                                                    tick: {
                                                        culling: false,
                                                        format: '%m-%Y'
                                                    }
                                                }
                                            }
                                        });
                                        forComparison_NoCipherSuitesAccepted = c3.generate({
                                            legend: {
                                                show: true,
                                                position: 'right'
                                            },
                                            size: {
                                                width: 640
                                            },
                                            data: {
                                                x: 'x',
                                                columns: [
                                                    result.months,
                                                    result.totalCiphersAccepting,
                                                    result.hostsAccepting
                                                ],
                                                types: {
                                                    'Total: Cipher Suites Accepted': 'spline',
                                                    'Cipher Suites Accepted': 'spline'
                                                }
                                            },
                                            axis: {
                                                x: {
                                                    type: 'timeseries',
                                                    tick: {
                                                        culling: false,
                                                        format: '%m-%Y'
                                                    }
                                                }
                                            }
                                        });
                                        document.getElementById("rememberNoCipherSuites_Accepted").style = "display: block; margin: 0 auto;";
                                        noCipherSuites_Preferred = c3.generate({
                                            bindto: '#noCipherSuites_Preferred',
                                            legend: {
                                                show: true,
                                                position: 'right'
                                            },
                                            size: {
                                                width: 640
                                            },
                                            data: {
                                                x: 'x',
                                                columns: [
                                                    result.months,
                                                    result.totalCiphersPreferring,
                                                    result.hostsPreferring
                                                ],
                                                types: {
                                                    'Total: Cipher Suites Preferred': 'spline',
                                                    'Cipher Suites Preferred': 'spline'
                                                }
                                            },
                                            axis: {
                                                x: {
                                                    type: 'timeseries',
                                                    tick: {
                                                        culling: false,
                                                        format: '%m-%Y'
                                                    }
                                                }
                                            }
                                        });
                                        forComparison_NoCipherSuitesPreferred = c3.generate({
                                            legend: {
                                                show: true,
                                                position: 'right'
                                            },
                                            size: {
                                                width: 640
                                            },
                                            data: {
                                                x: 'x',
                                                columns: [
                                                    result.months,
                                                    result.totalCiphersPreferring,
                                                    result.hostsPreferring
                                                ],
                                                types: {
                                                    'Total: Cipher Suites Preferred': 'spline',
                                                    'Cipher Suites Preferred': 'spline'
                                                }
                                            },
                                            axis: {
                                                x: {
                                                    type: 'timeseries',
                                                    tick: {
                                                        culling: false,
                                                        format: '%m-%Y'
                                                    }
                                                }
                                            }
                                        });
                                        document.getElementById("rememberNoCipherSuites_Preferred").style = "display: block; margin: 0 auto;";
                                        if (result.months.length > 1) {
                                            var totalCiphersAcceptedKey = result.totalCiphersAccepting[0];
                                            var totalCiphersAcceptedValue = result.totalCiphersAccepting[result.totalCiphersAccepting.length - 1];
                                            var totalCiphersPreferredKey = result.totalCiphersPreferring[0];
                                            var totalCiphersPreferredValue = result.totalCiphersPreferring[result.totalCiphersPreferring.length - 1];
                                            var percentageTotalCiphersPreferring = Math.round((totalCiphersPreferredValue / totalCiphersAcceptedValue * 100) * 100) / 100;
                                            var hostsAcceptingKey = result.hostsAccepting[0];
                                            var hostsAcceptingValue = result.hostsAccepting[result.hostsAccepting.length - 1];
                                            var hostsPreferringKey = result.hostsPreferring[0];
                                            var hostsPreferringValue = result.hostsPreferring[result.hostsPreferring.length - 1];
                                            var percentageAccepting = Math.round((hostsAcceptingValue / totalCiphersAcceptedValue * 100) * 100) / 100;
                                            var percentagePreferring = Math.round((hostsPreferringValue / totalCiphersPreferredValue * 100) * 100) / 100;
                                            lastMonth_Accepted = c3.generate({
                                                bindto: '#lastMonth_Accepted',
                                                legend: {
                                                    show: true,
                                                    position: 'right'
                                                },
                                                size: {
                                                    width: 640,
                                                    height: 200
                                                },
                                                padding: {
                                                    bottom: 20
                                                },
                                                gauge: {
                                                    label: {
                                                        show: false,
                                                        format: function (value, ratio) {
                                                            return "";
                                                        }
                                                    }
                                                },
                                                color: {
                                                    pattern: ['#E5AC32', '#326BE5'],
                                                    threshold: {
                                                        values: [percentageAccepting + 0.01, 100]
                                                    }
                                                },
                                                data: {
                                                    columns: [
                                                        [totalCiphersAcceptedKey, 100],
                                                        [hostsAcceptingKey, percentageAccepting]
                                                    ],
                                                    type: 'gauge'
                                                }
                                            });
                                            forComparison_LastMonthAccepted = c3.generate({
                                                legend: {
                                                    show: true,
                                                    position: 'right'
                                                },
                                                size: {
                                                    width: 640,
                                                    height: 200
                                                },
                                                padding: {
                                                    bottom: 20
                                                },
                                                gauge: {
                                                    label: {
                                                        show: false,
                                                        format: function (value, ratio) {
                                                            return "";
                                                        }
                                                    }
                                                },
                                                color: {
                                                    pattern: ['#E5AC32', '#326BE5'],
                                                    threshold: {
                                                        values: [percentageAccepting + 0.01, 100]
                                                    }
                                                },
                                                data: {
                                                    columns: [
                                                        [totalCiphersAcceptedKey, 100],
                                                        [hostsAcceptingKey, percentageAccepting]
                                                    ],
                                                    type: 'gauge'
                                                }
                                            });
                                            document.getElementById("rememberLastMonth_Accepted").style = "display: block; margin: 0 auto;";
                                            lastMonth_Preferred = c3.generate({
                                                bindto: '#lastMonth_Preferred',
                                                legend: {
                                                    show: true,
                                                    position: 'right'
                                                },
                                                size: {
                                                    width: 640,
                                                    height: 200
                                                },
                                                padding: {
                                                    bottom: 20
                                                },
                                                gauge: {
                                                    label: {
                                                        show: false,
                                                        format: function (value, ratio) {
                                                            return "";
                                                        }
                                                    }
                                                },
                                                color: {
                                                    pattern: ['#E5AC32', '#326BE5'],
                                                    threshold: {
                                                        values: [percentagePreferring + 0.01, 100]
                                                    }
                                                },
                                                data: {
                                                    columns: [
                                                        [totalCiphersPreferredKey, 100],
                                                        [hostsPreferringKey, percentagePreferring]
                                                    ],
                                                    type: 'gauge'
                                                }
                                            });
                                            forComparison_LastMonthPreferred = c3.generate({
                                                legend: {
                                                    show: true,
                                                    position: 'right'
                                                },
                                                size: {
                                                    width: 640,
                                                    height: 200
                                                },
                                                padding: {
                                                    bottom: 20
                                                },
                                                gauge: {
                                                    label: {
                                                        show: false,
                                                        format: function (value, ratio) {
                                                            return "";
                                                        }
                                                    }
                                                },
                                                color: {
                                                    pattern: ['#E5AC32', '#326BE5'],
                                                    threshold: {
                                                        values: [percentagePreferring + 0.01, 100]
                                                    }
                                                },
                                                data: {
                                                    columns: [
                                                        [totalCiphersPreferredKey, 100],
                                                        [hostsPreferringKey, percentagePreferring]
                                                    ],
                                                    type: 'gauge'
                                                }
                                            });
                                            document.getElementById("rememberLastMonth_Preferred").style = "display: block; margin: 0 auto;";
                                        }
                                    }

                                }
                                displayDescriptions();
                            } else {
                                if (tryCount < 2) {
                                    tryCount++;
                                    setTimeout(function () {
                                        $("#filterApply").click();
                                    }, 1000);
                                } else {
                                    tryCount = 0;
                                    alert("Currently unable to establish a database connection. Please verify your Internet connectivity.");
                                }
                            }
                        });
                    </script>
                </fieldset>
            </form>
        </div>
        <div id="warningMessage" style="text-align: center; display: none">
            <img src="img/warning.png" title="Warning">
            <p>Unable to calculate total number of hosts. Displaying total number of cipher suites instead.</p>
        </div>
    </div>
</div>

<!-- Operations for graph comparison-->
<div id="graphComparisonButtonPanel" class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">Graph Comparison</h3>
    </div>
    <div class="panel-body">
        <form>
            <fieldset>
                <div id="compareButtons">
                    <input id="comparisonShow" type="button" value="Show Graphs" />
                    <input id="comparisonClear" type="reset" value="Clear Graphs" onClick="forgetGraphs()" />
                </div>
            </fieldset>
            <script>
                $('#comparisonShow').click(function () {
                    if (getRememberedElements().graphs.length === 0) {
                        displayWarningNoGraphs(true);
                    } else {
                        manageElementVisibility(false);
                        displayWarningNoGraphs(false);
                        document.getElementById("graphComparison").contentWindow.displayGraphs(getRememberedElements());
                    }

                });

                function closeComparison() {
                    manageElementVisibility(true);
                }
            </script>
        </form>
        <div id="warningMessageNoGraphs" style="text-align: center; display: none">
            <img src="img/warning.png" title="Warning">
            <p>Nothing to display yet. Why don't you start by creating a few graphs?</p>
        </div>
    </div>
</div>
