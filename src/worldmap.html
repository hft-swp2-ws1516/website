<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TLS analyser</title>
    <!-- CSS Stylesheets -->
    <link rel="stylesheet" href="css/statistics.css">
    <link href="css/site.css" rel="stylesheet">
    <link rel="stylesheet" href="css/toggle.css">
    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- Load c3.css -->
    <link href="css/c3/c3.css" rel="stylesheet" type="text/css">
    <!-- jquery ui css -->
    <link rel="stylesheet" type="text/css" href="css/jquery-ui.css">
    <link rel="stylesheet" type="text/css" media="screen" href="css/datepicker/bootstrap-datepicker3.css">
</head>

</html>

<body>
    <div id="nav01"></div>
    <div class="container">
        <div class="col-md-12 col-xs-12 col-lg-12" align="center" >
            <div id="map" style="width: 100%; height: 500px; "></div>
            <div id="results" style=" width: 160px;
            height: 160px;
            position: absolute;
            left: 0;
            top: 300px;
            border: 3px solid #fff;
            opacity: 0.9;">
            <p> Land: <b id='land'> </b> </p>
            <p> TLD: <b id='resultTld'> </b> </p>
            <p> PFS Enabled: <b id='resultPFSen'> </b></p>
            <p> PFS Disabled:<b id='resultPFSdis'> </b></p>
            <p>  Total Hosts:<b id='resultTotalHosts'> </b></p>
        </div>

    </div>
</div>
</body>

<footer id="footer"></footer>
<div id="subscribe"></div>
<!-- Skripts are located in the end of the Body tag for faster Page Loading -->
<!-- Load d3.js and c3.js -->
<script src="js/c3/d3.min.js" charset="utf-8"></script>
<script src="js/c3/c3.min.js"></script>
<!-- JQuery CDN -->
<script src="js/jquery-1.11.3.min.js"></script>
<!-- Filter Menu -->
<script type="text/javascript" src="js/filterData.js"></script>
<!-- Bootstrap -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
<!-- for the menu -->
<script src="js/main/menu.js"></script>
<script type="text/javascript" src="js/datepicker/bootstrap-datepicker.js"></script>
<!--
        This map was created using Pixel Map Generator by amCharts and is licensed under the Creative Commons Attribution 4.0 International License.
        You may use this map the way you see fit as long as proper attribution to the name of amCharts is given in the form of link to http://pixelmap.amcharts.com/
        To view a copy of this license, visit http://creativecommons.org/licenses/by/4.0/

        If you would like to use this map without any attribution, you can acquire a commercial license for the JavaScript Maps - a tool that was used to produce this map.
        To do so, visit amCharts Online Store: http://www.amcharts.com/online-store/
    -->

    <!-- amCharts javascript sources -->
    <script type="text/javascript" src="js/ammap/ammap.js"></script>
    <script type="text/javascript" src="js/ammap/maps/js/worldLow.js"></script>

    <!-- amCharts javascript code -->
    <script type="text/javascript">
    var map =AmCharts.makeChart("map", {
        "type": "map",
        "pathToImages": "js/ammap/images/",
        "addClassNames": true,
        "fontSize": 15,
        "color": "#FFFFFF",
        "backgroundAlpha": 1,
        "backgroundColor": "#FFFFFF",
        "dataProvider": {
            "map": "worldLow",
            "getAreasFromMap": true,
            "images": [
            {
                "top": 40,
                "left": 60,
                "width": 80,
                "height": 40,
                "pixelMapperLogo": true,
            }
            ]
        },
        "balloon": {
            "horizontalPadding": 15,
            "borderAlpha": 0,
            "borderThickness": 1,
            "verticalPadding": 15
        },
        "areasSettings": {
            "color": "rgba(129,129,129,1)",
            "outlineColor": "rgba(80,80,80,1)",
            "rollOverOutlineColor": "rgba(80,80,80,1)",
            "rollOverBrightness": 20,
            "selectedBrightness": 20,
            "selectable": true,
            "unlistedAreasAlpha": 0,
            "unlistedAreasOutlineAlpha": 0
        },
        "imagesSettings": {
            "alpha": 1,
            "color": "rgba(129,129,129,1)",
            "outlineAlpha": 0,
            "rollOverOutlineAlpha": 0,
            "outlineColor": "rgba(80,80,80,1)",
            "rollOverBrightness": 20,
            "selectedBrightness": 20,
            "selectable": true
        },
        "linesSettings": {
            "color": "rgba(129,129,129,1)",
            "selectable": true,
            "rollOverBrightness": 20,
            "selectedBrightness": 20
        },
        "zoomControl": {
            "zoomControlEnabled": true,
            "homeButtonEnabled": true,
            "panControlEnabled": true,
            "right": 38,
            "bottom": 30,
            "minZoomLevel": 0.25,
            "gridHeight": 100,
            "gridAlpha": 0.1,
            "gridBackgroundAlpha": 0,
            "gridColor": "#FFFFFF",
            "draggerAlpha": 1,
            "buttonCornerRadius": 2
        }
    });
var dateObj= new Date();
var month=dateObj.getUTCMonth()+1;
var year=dateObj.getUTCFullYear();
var dateFormat=year+"_"+month;
console.log(dateFormat+" what");
var jsonRespond;
var jsonOnDate;
var PFSLand=jQuery.get("https://www.hotcat.de:1337/api/v0/pfs/overview", function (response) {
    jsonRespond=response;
    jsonOnDate=jsonRespond.filter(function(a){return a._id ==dateFormat})[0].overviews;

    console.log(jsonOnDate);


});
function objectFindByKey(array, key, value) {
    if (value=='gb'){
        value='uk';
    }
    for (var i = 0; i < array.length; i++) {
        if (array[i][key] === value) {
            console.log(array[i]);
            return array[i];
        }
    }
    return null;

};
    //    var chart=c3.generate({
    //        bindto:'result',
    //        data:{
    //            json:jsonTLD,
    //            keys:{
    //                value:['pfsEnabled', 'pfsDisabled']
    //            },
    //            type:'pie'
    //        },
    //    });

    /*  var div=document.createElement('div');
     div.setAttribute('tld',elements.tld);
     div.innerHTML=elements.pfsEnabled+'<br />'+elements.pfsDisabled+'<br />'
     +elements.totalHosts+'<br />';
     document.body.appendChild(div);
 };*/
    /*
     array[i].forEach(function(elements){
     arrayElement(elements);
     });
*/
map.addListener("clickMapObject",function(event){
        //event.mapObject.title
        function toLower(str){
            return str.toLowerCase();
        }
        console.log(toLower(event.mapObject.id+" EVENT id"));
        var obj=objectFindByKey(jsonOnDate, 'tld', toLower(event.mapObject.id));
        console.log(obj+" ;obj");
        console.log(JSON.stringify(obj.tld)+" ;obj stringfy");
        var land =event.mapObject.title;
        var tld=JSON.stringify(obj.tld);
        var pfsEnabled=JSON.stringify(obj.pfsEnabled);
        var pfsDisabled=JSON.stringify(obj.pfsDisabled);
        var totalHosts=JSON.stringify(obj.totalHosts);
        // var refString=reformedObj[0].NodeName[1];
        //console.log(refString);
        document.getElementById("land").innerHTML=land+'<br >' ;
        document.getElementById("resultTld").innerHTML=tld+'<br >' ;
        document.getElementById("resultPFSen").innerHTML=pfsEnabled+'<br >';
        document.getElementById("resultPFSdis").innerHTML=pfsDisabled+'<br >';
        document.getElementById("resultTotalHosts").innerHTML=totalHosts+'<br >';

    });
</script>